<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Abstract Factory • やったこと</title><meta name="description" content="Abstract Factory - ytetsuro"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="抽象クラスを生成する抽象クラスを利用したデザインパターン。「抽象的な工場」と訳される場合があると言われているが、言われている例をあまり見たことがない。 同じような構造のクラスを生成するパターンが複数に分岐する場合に有効。Factory Methodパターンとの違いは正直よくわかっていないけど、Factory Methodをいっぱい作ったらAbstract Factoryなんじゃないの？ぐらいの認識">
<meta name="keywords" content="PHP,Design Pattern,GoF">
<meta property="og:type" content="article">
<meta property="og:title" content="Abstract Factory">
<meta property="og:url" content="https://ytetsuro.github.io/blog/2018/05/17/Abstract-Factory/index.html">
<meta property="og:site_name" content="やったこと">
<meta property="og:description" content="抽象クラスを生成する抽象クラスを利用したデザインパターン。「抽象的な工場」と訳される場合があると言われているが、言われている例をあまり見たことがない。 同じような構造のクラスを生成するパターンが複数に分岐する場合に有効。Factory Methodパターンとの違いは正直よくわかっていないけど、Factory Methodをいっぱい作ったらAbstract Factoryなんじゃないの？ぐらいの認識">
<meta property="og:locale" content="ja">
<meta property="og:image" content="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuShCAqajIajCJbLmoopEoCnB3ydFpobMgEPIKD1M24fDpL58Joq1qHgQ4A7y50MmK7uAKAIM2ya0i6gGHeMIej8y35cWHh1aGMbE3aGIhC56Jm_5QYwGGWn1BeVKl1IWUm40">
<meta property="og:image" content="https://www.plantuml.com/plantuml/svg/TL4z3i8W5DxVATweCUa9EdGm7i0ukf3oh2G81cWSgdUN7sk1waJo_GETTSouyIP1A4Vcmdh2Wx1NeOQJrjBY18WxF1997CY5SxDDaEOO8SqzyWBe9REsC9_tJ3pOAa9-8sQeZ0XmPaLdHbNmckVqVOo1dbwk49ChSyRwwPKr6jfdqsJj47G9cnkJyDFUUcPzNLZc_H50yS2nu9SgJQh8jAa6eIF5_IU-0G00">
<meta property="og:image" content="https://www.plantuml.com/plantuml/svg/fL9B3i8W4DtFAMQfCUa9N7HXF82wT4CALX8Afj2uKEyk7zCERTKOLoJlC_CUK5h7MjSr2gHseZsnIk1MshFKzS4OPV46Y2lS2Q6m5YwSYsM23CS86UwH1q2bcBMP-RYN3TFclnaR9g_iXn53ZwWEHdHjfoUiDqRoqYb5jmSRJKxSBu7X6JyxO8WzwoVqO8-1r_UYe1d6Q7H2I9-mFaoE9HdGCcjFpJmFa3xl940wJJHzeiy2oFvL33gtwekAz9eiIZSm1g4KcliV_WG0">
<meta property="og:updated_time" content="2018-05-17T09:58:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Abstract Factory">
<meta name="twitter:description" content="抽象クラスを生成する抽象クラスを利用したデザインパターン。「抽象的な工場」と訳される場合があると言われているが、言われている例をあまり見たことがない。 同じような構造のクラスを生成するパターンが複数に分岐する場合に有効。Factory Methodパターンとの違いは正直よくわかっていないけど、Factory Methodをいっぱい作ったらAbstract Factoryなんじゃないの？ぐらいの認識">
<meta name="twitter:image" content="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuShCAqajIajCJbLmoopEoCnB3ydFpobMgEPIKD1M24fDpL58Joq1qHgQ4A7y50MmK7uAKAIM2ya0i6gGHeMIej8y35cWHh1aGMbE3aGIhC56Jm_5QYwGGWn1BeVKl1IWUm40">
<meta name="twitter:creator" content="@iBotchME"><link rel="icon" href="/blog/favicon.svg"><link rel="stylesheet" href="//cdn.rawgit.com/tiaanduplessis/nanoreset/master/nanoreset.min.css"><link rel="stylesheet" href="/blog/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/blog/atom.xml" title="やったこと"></head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/blog/" title="やったこと"><img class="logo-image" src="/blog/logo.svg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/about" target="_self">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="https://github.com/ytetsuro" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/atom.xml" target="_self">RSS</a></li></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Abstract Factory</h1><div class="post-info"><a></a>2018-05-17</div><div class="post-content"><p>抽象クラスを生成する抽象クラスを利用したデザインパターン。<br>「抽象的な工場」と訳される場合があると言われているが、<strong>言われている例をあまり見たことがない。</strong></p>
<p>同じような構造のクラスを生成するパターンが複数に分岐する場合に有効。<br>Factory Methodパターンとの違いは正直よくわかっていないけど、Factory Methodをいっぱい作ったらAbstract Factoryなんじゃないの？ぐらいの認識。</p>
<h2 id="例"><a href="#例" class="headerlink" title="例"></a>例</h2><p><code>釣り具</code>メーカの<code>リール</code>と<code>ロッド</code>を生成するFactoryクラスがあり、<br>それぞれの、メーカは<code>simano</code>と<code>Daiwa</code>を準備する場合。</p>
<h3 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h3><h4 id="重要なところ"><a href="#重要なところ" class="headerlink" title="重要なところ"></a>重要なところ</h4><p>Abstract Factoryクラスで抽象クラスを生成するようにメソッドを定義する。<br>また、Abstract Factoryクラス自体も抽象クラスとして実装する。</p>
<p><img src="https://www.plantuml.com/plantuml/svg/SoWkIImgAStDuShCAqajIajCJbLmoopEoCnB3ydFpobMgEPIKD1M24fDpL58Joq1qHgQ4A7y50MmK7uAKAIM2ya0i6gGHeMIej8y35cWHh1aGMbE3aGIhC56Jm_5QYwGGWn1BeVKl1IWUm40"></p>
<p>あとは、Factoryクラスの<code>パターン</code>として具象クラスを作る。<br>以下の例では、Daiwaファクトリクラスを作っている。</p>
<p><img src="https://www.plantuml.com/plantuml/svg/TL4z3i8W5DxVATweCUa9EdGm7i0ukf3oh2G81cWSgdUN7sk1waJo_GETTSouyIP1A4Vcmdh2Wx1NeOQJrjBY18WxF1997CY5SxDDaEOO8SqzyWBe9REsC9_tJ3pOAa9-8sQeZ0XmPaLdHbNmckVqVOo1dbwk49ChSyRwwPKr6jfdqsJj47G9cnkJyDFUUcPzNLZc_H50yS2nu9SgJQh8jAa6eIF5_IU-0G00"></p>
<p>こうすることにより、Factoryクラスを<code>パターン</code>で分けることができる。<br>今回の例では、FishingTools(釣り具)のパターンがDaiwaとsimanoが存在するため、</p>
<ul>
<li>Daiwaとsimanoを<code>具象クラス</code>として定義</li>
<li>FishingTools(釣り具)を<code>抽象クラス</code>として定義</li>
</ul>
<p>これによりクライアントコードは<code>抽象クラス</code>へ依存させることができるようになる。</p>
<h4 id="全体像"><a href="#全体像" class="headerlink" title="全体像"></a>全体像</h4><p><img src="https://www.plantuml.com/plantuml/svg/fL9B3i8W4DtFAMQfCUa9N7HXF82wT4CALX8Afj2uKEyk7zCERTKOLoJlC_CUK5h7MjSr2gHseZsnIk1MshFKzS4OPV46Y2lS2Q6m5YwSYsM23CS86UwH1q2bcBMP-RYN3TFclnaR9g_iXn53ZwWEHdHjfoUiDqRoqYb5jmSRJKxSBu7X6JyxO8WzwoVqO8-1r_UYe1d6Q7H2I9-mFaoE9HdGCcjFpJmFa3xl940wJJHzeiy2oFvL33gtwekAz9eiIZSm1g4KcliV_WG0"></p>
<h3 id="PHPで書いてみる"><a href="#PHPで書いてみる" class="headerlink" title="PHPで書いてみる"></a>PHPで書いてみる</h3><p>FishingTools(Abstract Factory)<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">FishingTools</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getReel</span><span class="params">()</span> : <span class="title">Reel</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRod</span><span class="params">()</span> : <span class="title">Rod</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Daiwa(Concrete Factory)<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">FishingTools</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Reel</span>\<span class="title">Daiwa</span> <span class="title">as</span> <span class="title">DaiwaReel</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Rod</span>\<span class="title">Daiwa</span> <span class="title">as</span> <span class="title">DaiwaRod</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Daiwa</span> <span class="keyword">implements</span> <span class="title">FishingTools</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getReel</span><span class="params">()</span> : <span class="title">Reel</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DaiwaReel(); <span class="comment">// 具象クラスに依存</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRod</span><span class="params">()</span> : <span class="title">Rod</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DaiwaRod(); <span class="comment">// 具象クラスに依存</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Client Code<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fisher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> $reel;</span><br><span class="line">  <span class="keyword">private</span> $rod;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(FishingTools $tools)</span> // &lt;- 抽象に依存</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;reel = $tools-&gt;getReel();</span><br><span class="line">    <span class="keyword">$this</span>-&gt;rod  = $tools-&gt;getRod();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">playFishing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">$this</span>-&gt;reel-&gt;trun()) &#123;</span><br><span class="line">      <span class="comment">// @<span class="doctag">todo:</span> 釣れたか判定を書く</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$fishingTools = <span class="keyword">new</span> FishingTools\Daiwa();</span><br><span class="line">$fisher = <span class="keyword">new</span> Fisher($fishingTools);</span><br><span class="line">$fisher-&gt;playFishing();</span><br></pre></td></tr></table></figure></p>
<p>このようにClient Codeを抽象クラスに依存させることによって、<br>$fishingToolsはDaiwaでもsimanoでも釣り具を生成できればなんでもいい状態ができる。</p>
<p>この、抽象クラスに依存できるところにOOP的な旨味があるのではないかと思う。</p>
<h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><ol>
<li><code>抽象クラス(Abstract Class)</code>を生成する<code>抽象クラス(Abstract Factory)</code>を作る</li>
<li>実際にどの<code>具象クラス(Concrete Class)</code>を生成するのかは<code>具象クラス(Concrete Factory)</code>に実装する</li>
</ol>
<h2 id="所感"><a href="#所感" class="headerlink" title="所感"></a>所感</h2><p>動機としては、会社でデザインパターンについてどれほど理解があるのかのアンケートがあった。<br>デザインパターンの復習と学習のため、アンケートででてきたデザインパターンを1日ずつPHPで書いてみようと思う。</p>
<p>39種類あったので6/24ぐらいには39種類全て書けるかと思う。</p>
<p>また、デザインパターンについては自信があまりないので</p>
<ul>
<li>これで伝わるのか</li>
<li>そもそも認識が正しいのか</li>
</ul>
<p>が不安</p>
<p><a href="https://ja.wikipedia.org/wiki/Abstract_Factory_%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3" target="_blank" rel="noopener">Wiki Pedia</a><br><a href="http://www.ie.u-ryukyu.ac.jp/~e085739/java.it.2.html" target="_blank" rel="noopener">参考</a></p>
</div></article></div></main><footer><div class="paginator"><a class="next" href="/blog/2018/05/16/Hexoを使ってBlogを構築してみた/">next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ytetsuro';
var disqus_identifier = '2018/05/17/Abstract-Factory/';
var disqus_title = 'Abstract Factory';
var disqus_url = 'https://ytetsuro.github.io/blog/2018/05/17/Abstract-Factory/';
(function () {
    var dsq = document.createElement('script'); dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ytetsuro.disqus.com/count.js" async></script><a class="twitter-share-button" href="https://ytetsuro.github.io/blog/2018/05/17/Abstract-Factory/" data-show-count="false">Tweet</a><script src="https://platform.twitter.com/widgets.js" charset="utf-8" async></script><div class="copyright"><p>&copy; 2018 <a href="https://ytetsuro.github.io/blog">ytetsuro</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119327110-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-119327110-1');</script><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>